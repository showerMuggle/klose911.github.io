<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>微服务打包和升级</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Wu, Shanliang" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="css/main.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">微服务打包和升级</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc2d043c">项目结构</a>
<ul>
<li><a href="#orgf03bf8f">com.ebao.base.parent</a>
<ul>
<li><a href="#org3d9d338">git</a></li>
<li><a href="#org547b11a">propertity</a></li>
<li><a href="#org8050b62">plugin</a></li>
<li><a href="#org7f4d56c">profile</a></li>
</ul>
</li>
<li><a href="#org379bf8e">ebaocloud-base-parent</a>
<ul>
<li><a href="#orgd54c409">code</a></li>
<li><a href="#org84c0967">property</a></li>
<li><a href="#org374b001">plugin</a></li>
<li><a href="#org212606d">dependency management</a></li>
<li><a href="#org937d797">profile</a></li>
</ul>
</li>
<li><a href="#org5d446e1">platform-boot</a>
<ul>
<li><a href="#org4fafa79">git</a></li>
</ul>
</li>
<li><a href="#org6594b81">platform-starters</a>
<ul>
<li><a href="#org0300206">git</a></li>
<li><a href="#org1608840">property</a></li>
<li><a href="#org4dafada">dependency</a></li>
<li><a href="#orgb4d2f3a">modules</a></li>
<li><a href="#orgd609d3c">starter</a></li>
<li><a href="#org34440e4">微服务工程</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org946b34b">项目依赖</a>
<ul>
<li><a href="#orga464e6d">升级boot</a></li>
<li><a href="#org9c51668">升级starter</a></li>
</ul>
</li>
<li><a href="#orge7c890a">升级流程</a>
<ul>
<li><a href="#org7f5d7ee">boot升级</a></li>
<li><a href="#org32f65bd">starters 升级</a></li>
<li><a href="#org967d589">ebaocloud base parent 升级</a></li>
</ul>
</li>
<li><a href="#orgd57a2b5">问题和建议</a>
<ul>
<li><a href="#orga8ab40e">循环依赖</a></li>
<li><a href="#org94f450f">升级脚本</a></li>
<li><a href="#orgbd24e9c">项目合并</a></li>
<li><a href="#orged917a2">功能减少</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgc2d043c" class="outline-2">
<h2 id="orgc2d043c">项目结构</h2>
<div class="outline-text-2" id="text-orgc2d043c">
</div>
<div id="outline-container-orgf03bf8f" class="outline-3">
<h3 id="orgf03bf8f">com.ebao.base.parent</h3>
<div class="outline-text-3" id="text-orgf03bf8f">
<p>
基于maven插件定义了编译，打包，组装等一系列的流程
</p>
</div>
<div id="outline-container-org3d9d338" class="outline-4">
<h4 id="org3d9d338">git</h4>
<div class="outline-text-4" id="text-org3d9d338">
<p>
git页面：<a href="https://oss.ebaotech.com/unicorn-foundation/com.ebao.base.parent">https://oss.ebaotech.com/unicorn-foundation/com.ebao.base.parent</a>
</p>
</div>
</div>

<div id="outline-container-org547b11a" class="outline-4">
<h4 id="org547b11a">propertity</h4>
<div class="outline-text-4" id="text-org547b11a">
<div class="org-src-container">
<pre class="src src-xml"><span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#32534;&#35793;&#29615;&#22659;&#35774;&#32622; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">project.build.sourceEncoding</span>&gt;UTF-8&lt;/<span style="color: #daa520; font-weight: bold;">project.build.sourceEncoding</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">project.build.resourceEncoding</span>&gt;UTF-8&lt;/<span style="color: #daa520; font-weight: bold;">project.build.resourceEncoding</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">maven.compile.encoding</span>&gt;UTF-8&lt;/<span style="color: #daa520; font-weight: bold;">maven.compile.encoding</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">compile.version</span>&gt;1.8&lt;/<span style="color: #daa520; font-weight: bold;">compile.version</span>&gt;

<span style="color: #5f9ea0; font-style: italic;">&lt;!--</span><span style="color: #5f9ea0; font-style: italic;">&#25171;&#21253;&#35774;&#32622;</span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">genereate-resource-dir</span>&gt;${project.build.directory}/generated-resources&lt;/<span style="color: #daa520; font-weight: bold;">genereate-resource-dir</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">release.center.repo</span>&gt;ftp://app.ebaotech.com/home/deploy/softwares/release-packages&lt;/<span style="color: #daa520; font-weight: bold;">release.center.repo</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">release.namespace</span>&gt;${project.artifactId}&lt;/<span style="color: #daa520; font-weight: bold;">release.namespace</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">lightweight.httpserver.version</span>&gt;1.5-SNAPSHOT&lt;/<span style="color: #daa520; font-weight: bold;">lightweight.httpserver.version</span>&gt;

&lt;<span style="color: #daa520; font-weight: bold;">skipApps</span>&gt;false&lt;/<span style="color: #daa520; font-weight: bold;">skipApps</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">app.activation.flagfile</span>&gt;markers/app.marker&lt;/<span style="color: #daa520; font-weight: bold;">app.activation.flagfile</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">assembly.release.attach</span>&gt;false&lt;/<span style="color: #daa520; font-weight: bold;">assembly.release.attach</span>&gt;
<span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">wrapper log&#25991;&#20214;&#31561;&#35774;&#32622; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>

&lt;<span style="color: #daa520; font-weight: bold;">wrapper.logfile.maxfiles</span>&gt;7&lt;/<span style="color: #daa520; font-weight: bold;">wrapper.logfile.maxfiles</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">wrapper.logfile.maxsize</span>&gt;50M&lt;/<span style="color: #daa520; font-weight: bold;">wrapper.logfile.maxsize</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">wrapper.logfile.loglevel</span>&gt;none&lt;/<span style="color: #daa520; font-weight: bold;">wrapper.logfile.loglevel</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">wrapper.disable_restarts</span>&gt;false&lt;/<span style="color: #daa520; font-weight: bold;">wrapper.disable_restarts</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">application.daemon</span>&gt;app&lt;/<span style="color: #daa520; font-weight: bold;">application.daemon</span>&gt;

<span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">jvm memory&#35774;&#32622; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span> 
&lt;<span style="color: #daa520; font-weight: bold;">application.initialMemorySize</span>&gt;100M&lt;/<span style="color: #daa520; font-weight: bold;">application.initialMemorySize</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">application.maxMemorySize</span>&gt;1024M&lt;/<span style="color: #daa520; font-weight: bold;">application.maxMemorySize</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">application.maxStackSize</span>&gt;128M&lt;/<span style="color: #daa520; font-weight: bold;">application.maxStackSize</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">application.maxMetaspaceSize</span>&gt;256M&lt;/<span style="color: #daa520; font-weight: bold;">application.maxMetaspaceSize</span>&gt;

<span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">pinpoint &#25171;&#21253;&#37197;&#32622; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">plugins.ext.dir</span>&gt;${project.build.directory}/app-plugins&lt;/<span style="color: #daa520; font-weight: bold;">plugins.ext.dir</span>&gt;
<span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">pinpoint plugins &#24403;markers&#30446;&#24405;&#23384;&#22312;pinpoint.marker&#25991;&#20214;&#26102;,&#33258;&#21160;&#19979;&#36733;agent,&#22312;&#26368;&#21518;&#30340;sap&#21253;&#20013;&#21152;&#20837;&#19968;&#20010;agent </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">pinpoint.activation.flagfile</span>&gt;markers/pinpoint.marker&lt;/<span style="color: #daa520; font-weight: bold;">pinpoint.activation.flagfile</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">pinpoint.agent.groupId</span>&gt;com.navercorp.pinpoint&lt;/<span style="color: #daa520; font-weight: bold;">pinpoint.agent.groupId</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">pinpoint.agent.artifactId</span>&gt;pinpoint-agent&lt;/<span style="color: #daa520; font-weight: bold;">pinpoint.agent.artifactId</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">pinpoint.agent.version</span>&gt;1.3.2&lt;/<span style="color: #daa520; font-weight: bold;">pinpoint.agent.version</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">pinpoint.opts</span>&gt;-Dpinpoint.profiler=false&lt;/<span style="color: #daa520; font-weight: bold;">pinpoint.opts</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">pinpoint.applicationName</span>&gt;${project.artifactId}&lt;/<span style="color: #daa520; font-weight: bold;">pinpoint.applicationName</span>&gt;
</pre>
</div>

<pre class="example">
  其余的关于 docker打包，npm 编译，gitbook编译， 基于liquidbase的dbasset配置, ccagent配置......

  这些都只有v4的一些工程可能在使用，云平台不用
</pre>
</div>
</div>

<div id="outline-container-org8050b62" class="outline-4">
<h4 id="org8050b62">plugin</h4>
<div class="outline-text-4" id="text-org8050b62">
<ul class="org-ul">
<li>wagon-ftp：ftp支持</li>
<li>maven-compiler-plugin ： 编译
<ul class="org-ul">
<li>支持 groovy</li>
</ul></li>
<li>maven-surefire-plugin: ut 测试</li>
<li>maven-source-plugin：是否包含源代码jar包</li>
<li>maven-war-plugin：支持war包</li>
<li>maven-install-plugin：安装jar包到本地</li>
<li>maven-deploy-plugin：部署jar包</li>
<li>maven-dependency-plugin : 处理依赖相关（主要用于数据库脚本依赖管理）
<ul class="org-ul">
<li>download-db-dependency-task：将依赖中的 '*.db.zip' 复制到 'target/db-dependencies' 目录</li>
<li>generate-module-dept-tree-task : 自动生成dept-tree文件</li>
<li>download-biz-dependency-task : 复制 biz数据包到依赖目录</li>
<li>copy-uimodule-zip-task: 将依赖中的*.uimodule.zip复制到target/uimodule-dependencies</li>
<li>unzip-pinpoint-zip-task: 将依赖中pinpoint agent 解压到target/pinpoint-agent</li>
<li>download-ccagent-task: 将ccagent 下载并解压到target/ccagent目录</li>
<li>unpack-adocframe-task</li>
</ul></li>
<li>maven-resources-plugin: 静态资源文件相关
<ul class="org-ul">
<li>prepare-dbmetadata-files-task：  准备一个dbasset.history文件到target/db-metadata目录,以供后续操作 有可能这个项目当前没有定义dbasset.history文件,可以自动创建一个</li>
<li>rewrite-dbmetadata-files-task：已经修改的过的dbasset.history文件 回写回去</li>
</ul></li>
<li>maven-antrun-plugin： 
<ul class="org-ul">
<li>copy-self-db-to-dependency-dir-task： 将自身的db复制到 依赖的目录</li>
<li>copy-self-biz-to-dependency-dir-task ：将自身的biz复制到 依赖的目录</li>
<li>copy-self-bizasset-to-assembly-dir-task：将bizasset copy到 另外一个目录target/assets以供装配 主要目的是精简文件名</li>
<li>ant-copy-template：模板拷贝</li>
</ul></li>
<li>frontend-maven-plugin： 前端npm打包等，使用ebao客户化的版本,修改一些问题 ，主要引入useSystem 属性</li>
<li>opts-maven-plugin：shawn实现的关于devopts相关的任务定义
<ul class="org-ul">
<li>generate-application-version-file-task : 生成版本号文件</li>
<li>其他有些关于dbassert的任务</li>
</ul></li>
<li>asciidoctor-maven-plugin： 不知道干嘛的</li>
<li>wagon-maven-plugin：将app release copy 软件的release仓库
<ul class="org-ul">
<li>deploy-release-package-task</li>
<li>deploy-uiapp-package-task</li>
<li>deploy-staticapp-package-task</li>
<li>deploy-docker-compose-task</li>
</ul></li>
<li>appassembler-maven-plugin：生成发布包（重要！）
<ul class="org-ul">
<li>启动jvm进程的wrapper的配置文件，jvm启动参数，pinpoint启动参数，会在这里被填入到发布包内</li>
</ul></li>
<li>maven-assembly-plugin：组装文档，数据库脚本，编译后的二进制文件（java, js等）</li>
<li>docker-maven-plugin：maven生成docker镜像</li>
<li>lifecycle-mapping：针对eclipse m2e插件的，貌似没啥用</li>
</ul>
</div>
</div>

<div id="outline-container-org7f4d56c" class="outline-4">
<h4 id="org7f4d56c">profile</h4>
<div class="outline-text-4" id="text-org7f4d56c">
<p>
根据源代码里是否存在某个特定名字的文件，来判断当前应用是否要激活某个profile 
</p>

<div class="org-src-container">
<pre class="src src-xml"><span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">pinpoint profile &#24403;markers&#30446;&#24405;&#23384;&#22312;pinpoint.markers&#30446;&#24405;&#26102;,&#19979;&#36733;&#25351;&#23450;&#30340;pinpoint agent,&#28982;&#21518;&#23558;pinpoint </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">profile</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;pinpoint-profile&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">activation</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">activeByDefault</span>&gt;false&lt;/<span style="color: #daa520; font-weight: bold;">activeByDefault</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">file</span>&gt;
      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#28608;&#27963;docker&#25191;&#34892;&#30340;&#25991;&#20214; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">exists</span>&gt;${pinpoint.activation.flagfile}&lt;/<span style="color: #daa520; font-weight: bold;">exists</span>&gt;
    &lt;/<span style="color: #daa520; font-weight: bold;">file</span>&gt;
  &lt;/<span style="color: #daa520; font-weight: bold;">activation</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">properties</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">pinpoint.opts</span>&gt;-javaagent:./plugins/pinpoint/pinpoint-bootstrap-${pinpoint.agent.version}.jar&lt;/<span style="color: #daa520; font-weight: bold;">pinpoint.opts</span>&gt;
  &lt;/<span style="color: #daa520; font-weight: bold;">properties</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">build</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">plugins</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.apache.maven.plugins&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;maven-dependency-plugin&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;unzip-pinpoint-zip-task&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">phase</span>&gt;process-sources&lt;/<span style="color: #daa520; font-weight: bold;">phase</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
    &lt;/<span style="color: #daa520; font-weight: bold;">plugins</span>&gt;
  &lt;/<span style="color: #daa520; font-weight: bold;">build</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">profile</span>&gt;
</pre>
</div>

<p>
假如在应用中存在 <span class="underline">/marker/pinpoint.marker</span> 这个文件，那么应用就激活了 <b>pinpoint</b> 这个profile，因此在 <span class="underline">process-sources</span> 阶段就会去执行前面 <span class="underline">maven-dependency-plugin</span> 插件中定义的 <span class="underline">unzip-pinpoint-zip-task</span> 任务 
</p>

<p>
云平台项目主要使用了这里定义的 app, pinpoint两个profile。app profile：主要定义了如何打出app的zip包（和jvm wrapper相关的任务）
</p>
<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">profile</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;app-profile&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">activation</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">activeByDefault</span>&gt;false&lt;/<span style="color: #daa520; font-weight: bold;">activeByDefault</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">file</span>&gt;
      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#22914;&#26524;&#23384;&#22312;&#33050;&#26412;,&#37027;&#20040;&#24517;&#28982;&#26159;&#19968;&#20010;application </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">exists</span>&gt;${app.activation.flagfile}&lt;/<span style="color: #daa520; font-weight: bold;">exists</span>&gt;
    &lt;/<span style="color: #daa520; font-weight: bold;">file</span>&gt;
  &lt;/<span style="color: #daa520; font-weight: bold;">activation</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">build</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">resources</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">resource</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">directory</span>&gt;${project.basedir}/src/main/resources&lt;/<span style="color: #daa520; font-weight: bold;">directory</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">resource</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">resource</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">directory</span>&gt;${genereate-resource-dir}&lt;/<span style="color: #daa520; font-weight: bold;">directory</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">resource</span>&gt;

    &lt;/<span style="color: #daa520; font-weight: bold;">resources</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">plugins</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#20316;&#20026;&#19968;&#20010;application,&#25552;&#20379;&#22312;&#21629;&#20196;&#34892;&#20013;&#21551;&#21160;&#30340;&#33021;&#21147; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.codehaus.mojo&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;exec-maven-plugin&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;1.5.0&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">mainClass</span>&gt;${application.mainclass}&lt;/<span style="color: #daa520; font-weight: bold;">mainClass</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!--</span><span style="color: #5f9ea0; font-style: italic;">&#20316;&#20026;&#24212;&#29992;,&#25171;&#21253;&#26102;&#24212;&#35813;&#25490;&#38500;src/main/resource&#19979;&#30340;&#25991;&#20214;,&#21542;&#21017;&#21487;&#33021;&#37325;&#22797; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.apache.maven.plugins&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;maven-jar-plugin&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;2.5&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">excludes</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">exclude</span>&gt;**/*.xml&lt;/<span style="color: #daa520; font-weight: bold;">exclude</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">excludes</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">phase</span>&gt;package&lt;/<span style="color: #daa520; font-weight: bold;">phase</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">goals</span>&gt;
              &lt;<span style="color: #daa520; font-weight: bold;">goal</span>&gt;jar&lt;/<span style="color: #daa520; font-weight: bold;">goal</span>&gt;
            &lt;/<span style="color: #daa520; font-weight: bold;">goals</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#23558;&#20381;&#36182;&#30340;uimodule &#35299;&#21387;&#21040; uimodule&#30340;&#20381;&#36182;&#30446;&#24405; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.apache.maven.plugins&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;maven-dependency-plugin&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;copy-uimodule-zip-task&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">phase</span>&gt;generate-sources&lt;/<span style="color: #daa520; font-weight: bold;">phase</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#20135;&#29983;jws&#25991;&#20214; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.codehaus.mojo&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;appassembler-maven-plugin&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;generate-jsw-scripts&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">phase</span>&gt;prepare-package&lt;/<span style="color: #daa520; font-weight: bold;">phase</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">goals</span>&gt;
              &lt;<span style="color: #daa520; font-weight: bold;">goal</span>&gt;generate-daemons&lt;/<span style="color: #daa520; font-weight: bold;">goal</span>&gt;
            &lt;/<span style="color: #daa520; font-weight: bold;">goals</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">execution</span>&gt;

          &lt;<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;generate-program-scripts&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">phase</span>&gt;prepare-package&lt;/<span style="color: #daa520; font-weight: bold;">phase</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">goals</span>&gt;
              &lt;<span style="color: #daa520; font-weight: bold;">goal</span>&gt;assemble&lt;/<span style="color: #daa520; font-weight: bold;">goal</span>&gt;
            &lt;/<span style="color: #daa520; font-weight: bold;">goals</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
              &lt;<span style="color: #daa520; font-weight: bold;">repositoryName</span>&gt;lib&lt;/<span style="color: #daa520; font-weight: bold;">repositoryName</span>&gt;
              &lt;<span style="color: #daa520; font-weight: bold;">generateRepository</span>&gt;false&lt;/<span style="color: #daa520; font-weight: bold;">generateRepository</span>&gt;
            &lt;/<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#20135;&#29983;&#24212;&#29992;&#32423;&#21035;&#30340;&#29256;&#26412;&#25991;&#20214; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.opts&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;opts-maven-plugin&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;generate-application-version-file-task&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">phase</span>&gt;generate-resources&lt;/<span style="color: #daa520; font-weight: bold;">phase</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#20135;&#29983;git&#30340;&#20449;&#24687;&#25991;&#20214;,&#22914;&#26524;&#26159;svn,&#33258;&#21160;&#24573;&#30053; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>

      &lt;<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;pl.project13.maven&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;git-commit-id-plugin&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;2.2.5&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;get-the-git-infos&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">goals</span>&gt;
              &lt;<span style="color: #daa520; font-weight: bold;">goal</span>&gt;revision&lt;/<span style="color: #daa520; font-weight: bold;">goal</span>&gt;
            &lt;/<span style="color: #daa520; font-weight: bold;">goals</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">phase</span>&gt;generate-resources&lt;/<span style="color: #daa520; font-weight: bold;">phase</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
          <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#22914;&#26524;&#27809;&#26377;&#21457;&#29616;git&#30446;&#24405;,&#33258;&#21160;&#24573;&#30053; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
          &lt;<span style="color: #daa520; font-weight: bold;">verbose</span>&gt;false&lt;/<span style="color: #daa520; font-weight: bold;">verbose</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">failOnNoGitDirectory</span>&gt;false&lt;/<span style="color: #daa520; font-weight: bold;">failOnNoGitDirectory</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">generateGitPropertiesFile</span>&gt;true&lt;/<span style="color: #daa520; font-weight: bold;">generateGitPropertiesFile</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">generateGitPropertiesFilename</span>&gt;${genereate-resource-dir}/git.properties&lt;/<span style="color: #daa520; font-weight: bold;">generateGitPropertiesFilename</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#35302;&#21457;application &#21253;(release)&#30340;&#26500;&#24314;,&#27492;&#26500;&#24314; &#19981;&#38656;&#35201;deploy&#21040;maven&#20179;&#24211; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.apache.maven.plugins&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;maven-assembly-plugin&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;release&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">phase</span>&gt;package&lt;/<span style="color: #daa520; font-weight: bold;">phase</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
              &lt;<span style="color: #daa520; font-weight: bold;">attach</span>&gt;${assembly.release.attach}&lt;/<span style="color: #daa520; font-weight: bold;">attach</span>&gt;
            &lt;/<span style="color: #daa520; font-weight: bold;">configuration</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#23558;application release copy &#21040; &#20132;&#20184;&#20013;&#24515; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.codehaus.mojo&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;wagon-maven-plugin&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
          &lt;<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;deploy-release-package-task&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
            &lt;<span style="color: #daa520; font-weight: bold;">phase</span>&gt;deploy&lt;/<span style="color: #daa520; font-weight: bold;">phase</span>&gt;
          &lt;/<span style="color: #daa520; font-weight: bold;">execution</span>&gt;
        &lt;/<span style="color: #daa520; font-weight: bold;">executions</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">plugin</span>&gt;
    &lt;/<span style="color: #daa520; font-weight: bold;">plugins</span>&gt;
  &lt;/<span style="color: #daa520; font-weight: bold;">build</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">profile</span>&gt;
</pre>
</div>
<p>
注意： 
</p>
<ol class="org-ol">
<li>一个应用可以有多个profile</li>
<li>现在云平台使用的profile不仅仅定义在这里，有些定义在下面的 ebaocloud-base-parent 工程</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org379bf8e" class="outline-3">
<h3 id="org379bf8e">ebaocloud-base-parent</h3>
<div class="outline-text-3" id="text-org379bf8e">
<p>
继承于 上面的 <span class="underline">com.ebao.base.parent</span> , 他的作用是：
</p>
<ol class="org-ol">
<li>管理spring boot等第三方库的版本</li>
<li>管理云品台提供的starter的版本</li>
<li>根据不同的profile包含不同的starter</li>
</ol>

<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">parent</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;com.ebao.base.parent&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;1.3.1&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">parent</span>&gt;
</pre>
</div>
</div>
<div id="outline-container-orgd54c409" class="outline-4">
<h4 id="orgd54c409">code</h4>
<div class="outline-text-4" id="text-orgd54c409">
<p>
git目录 <a href="https://oss.ebaotech.com/ebaocloud/ebaocloud-base-parent">https://oss.ebaotech.com/ebaocloud/ebaocloud-base-parent</a>
</p>
</div>
</div>

<div id="outline-container-org84c0967" class="outline-4">
<h4 id="org84c0967">property</h4>
<div class="outline-text-4" id="text-org84c0967">
<div class="org-src-container">
<pre class="src src-xml"><span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#25351;&#26126;&#22312;app.ebaotech.com&#19979;sap&#23384;&#20648;&#30340;namespace </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">release.namespace</span>&gt;ebaocloud&lt;/<span style="color: #daa520; font-weight: bold;">release.namespace</span>&gt;

<span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#25191;&#34892;&#22312;docker-all.repo.ebaotech.com docker image&#23384;&#20648;&#30340;namespace  </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">docker.prefix</span>&gt;ebaocloud&lt;/<span style="color: #daa520; font-weight: bold;">docker.prefix</span>&gt;

<span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">docker&#30340;&#40664;&#35748;tag </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">docker.build.image.version</span>&gt;latest&lt;/<span style="color: #daa520; font-weight: bold;">docker.build.image.version</span>&gt;

<span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">docker plugins&#30340;&#29256;&#26412; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">docker.build.plugin.version</span>&gt;0.4.11&lt;/<span style="color: #daa520; font-weight: bold;">docker.build.plugin.version</span>&gt;

<span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">spring boot </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">spring.boot.version</span>&gt;1.5.2.RELEASE&lt;/<span style="color: #daa520; font-weight: bold;">spring.boot.version</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">spring.cloud.version</span>&gt;Dalston.RELEASE&lt;/<span style="color: #daa520; font-weight: bold;">spring.cloud.version</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">ebaocloud.platform.version</span>&gt;1.3.8&lt;/<span style="color: #daa520; font-weight: bold;">ebaocloud.platform.version</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">springfox.swagger.version</span>&gt;2.7.0&lt;/<span style="color: #daa520; font-weight: bold;">springfox.swagger.version</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">product.name</span>&gt;platform&lt;/<span style="color: #daa520; font-weight: bold;">product.name</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">dependOn</span>&gt;&lt;/<span style="color: #daa520; font-weight: bold;">dependOn</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">dbasset.flat.enabled</span>&gt;true&lt;/<span style="color: #daa520; font-weight: bold;">dbasset.flat.enabled</span>&gt;
<span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">docker &#29615;&#22659;disable&#24322;&#24120;,&#20132;&#30001;&#23481;&#22120;&#20445;&#35777;</span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
&lt;<span style="color: #daa520; font-weight: bold;">wrapper.disable_restarts</span>&gt;TRUE&lt;/<span style="color: #daa520; font-weight: bold;">wrapper.disable_restarts</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">application.maxMemorySize</span>&gt;512M&lt;/<span style="color: #daa520; font-weight: bold;">application.maxMemorySize</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">pinpoint.agent.version</span>&gt;1.3.3&lt;/<span style="color: #daa520; font-weight: bold;">pinpoint.agent.version</span>&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-org374b001" class="outline-4">
<h4 id="org374b001">plugin</h4>
<div class="outline-text-4" id="text-org374b001">
<p>
其中比较重要的是 spring boot  和 spring cloud 的版本
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">spring.boot.version</span>&gt;1.5.2.RELEASE&lt;/<span style="color: #daa520; font-weight: bold;">spring.boot.version</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">spring.cloud.version</span>&gt;Dalston.RELEASE&lt;/<span style="color: #daa520; font-weight: bold;">spring.cloud.version</span>&gt;
</pre>
</div>

<p>
云平台starter插件的版本： 
</p>
<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">ebaocloud.platform.version</span>&gt;1.3.8&lt;/<span style="color: #daa520; font-weight: bold;">ebaocloud.platform.version</span>&gt;
</pre>
</div>

<pre class="example">
  注意：这里定义的属性可能会改写他父工程的属性

  比如：pinpoint.agent.version在父工程定义为1.3.2 , 这里定义成1.3.3 
</pre>
</div>
</div>

<div id="outline-container-org212606d" class="outline-4">
<h4 id="org212606d">dependency management</h4>
<div class="outline-text-4" id="text-org212606d">
<p>
使用上面定义的属性，在这里定义了spring boot, spring cloud 的库依赖版本
</p>
<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">dependencyManagement</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">dependencies</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.springframework.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;spring-cloud-dependencies&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;${spring.cloud.version}&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">type</span>&gt;pom&lt;/<span style="color: #daa520; font-weight: bold;">type</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">scope</span>&gt;import&lt;/<span style="color: #daa520; font-weight: bold;">scope</span>&gt;
    &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">Import dependency management from Spring Boot </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.springframework.boot&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;spring-boot-dependencies&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;${spring.boot.version}&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">type</span>&gt;pom&lt;/<span style="color: #daa520; font-weight: bold;">type</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">scope</span>&gt;import&lt;/<span style="color: #daa520; font-weight: bold;">scope</span>&gt;
    &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
    ......
</pre>
</div>

<p>
云平台自己的starter也在这里管理版本： 
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-configcenter&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;${ebaocloud.platform.version}&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

&lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-discoveryendpoint&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;${ebaocloud.platform.version}&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;


&lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-redis&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;${ebaocloud.platform.version}&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

&lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-netflixext&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;${ebaocloud.platform.version}&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
......
</pre>
</div>

<p>
还有其他的一些第三方库的版本，比如swagger 工具库
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;io.springfox&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;springfox-swagger2&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;${springfox.swagger.version}&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;io.springfox&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;springfox-swagger-ui&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;${springfox.swagger.version}&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-org937d797" class="outline-4">
<h4 id="org937d797">profile</h4>
<div class="outline-text-4" id="text-org937d797">
<p>
激活profile的机制和他的父工程类似，不同的是：
</p>
<ul class="org-ul">
<li>父工程com.ebao.base.parent 中不同的profile来定义不同的打包流程</li>
<li>这里根据不同的profile来定义会自动依赖那些云平台的starter</li>
</ul>

<p>
现在云平台服务主要使用的是这里定义的 <span class="underline">backend</span>  profile 
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">profiles</span>&gt;
  <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#21518;&#31471;&#31995;&#32479;</span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
  &lt;<span style="color: #daa520; font-weight: bold;">profile</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">id</span>&gt;backend-profile&lt;/<span style="color: #daa520; font-weight: bold;">id</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">activation</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">activeByDefault</span>&gt;false&lt;/<span style="color: #daa520; font-weight: bold;">activeByDefault</span>&gt;
      &lt;<span style="color: #daa520; font-weight: bold;">file</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">exists</span>&gt;markers/backend.marker&lt;/<span style="color: #daa520; font-weight: bold;">exists</span>&gt;                         
      &lt;/<span style="color: #daa520; font-weight: bold;">file</span>&gt;
    &lt;/<span style="color: #daa520; font-weight: bold;">activation</span>&gt;

    &lt;<span style="color: #daa520; font-weight: bold;">dependencies</span>&gt;1
      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;io.springfox&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;springfox-swagger2&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;io.springfox&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;springfox-swagger-ui&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-configcenter&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-discoveryendpoint&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-netflixext&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#24403;&#21069;&#23433;&#20840;&#26816;&#26597;&#21482;&#26159;&#36127;&#36131;&#33719;&#21462;token&#26631;&#35782;,&#19981;&#22788;&#29702;&#20854;&#20182;&#20449;&#24687; </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-security&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- </span><span style="color: #5f9ea0; font-style: italic;">&#26681;&#25454;&#23433;&#20840;&#32452;&#20214;&#33719;&#24471;&#19978;&#19979;&#25991;,&#24471;&#21040;&#29992;&#25143;context </span><span style="color: #5f9ea0; font-style: italic;">--&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-usercontext&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-redis&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-logger&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-swagger&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-httptrace&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-liquibase&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

      <span style="color: #5f9ea0; font-style: italic;">&lt;!-- --&gt;</span>
      &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
        &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-metrics&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
      &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

    &lt;/<span style="color: #daa520; font-weight: bold;">dependencies</span>&gt;
    &lt;/<span style="color: #daa520; font-weight: bold;">profile</span>&gt;
</pre>
</div>

<pre class="example">
copy-dockerfile-to-target 这个profile也会激活，

主要作用是把源代码的Dockerfile文件copy到target目录，来适应maven的docker插件

现在是把DockerFile放在源代码的某个固定位置，jenkins通过运行 docker 命令来打镜像，实际上这个profile已经不需要
</pre>
</div>
</div>
</div>
<div id="outline-container-org5d446e1" class="outline-3">
<h3 id="org5d446e1">platform-boot</h3>
<div class="outline-text-3" id="text-org5d446e1">
<p>
继承于 <span class="underline">ebaocloud-base-parent</span>  工程
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">parent</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebaocloud-base-parent&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;1.0.0-SNAPSHOT&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">parent</span>&gt;
</pre>
</div>
<p>
作用：定义了云平台starter和服务中需要用到的通用常量，数据模型，接口，工具类等
</p>
<ul class="org-ul">
<li>用户模型：UserDetail</li>
<li>http头常量</li>
<li>SessionService接口</li>
<li>&#x2026;&#x2026;</li>
</ul>
</div>
<div id="outline-container-org4fafa79" class="outline-4">
<h4 id="org4fafa79">git</h4>
<div class="outline-text-4" id="text-org4fafa79">
<p>
git页面 <a href="https://oss.ebaotech.com/ebaocloud/platform-boot">https://oss.ebaotech.com/ebaocloud/platform-boot</a> 
</p>
</div>
</div>
</div>

<div id="outline-container-org6594b81" class="outline-3">
<h3 id="org6594b81">platform-starters</h3>
<div class="outline-text-3" id="text-org6594b81">
<p>
继承于 <span class="underline">ebaocloud-base-parent</span>  工程
</p>
<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">parent</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebaocloud-base-parent&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;1.0.0-SNAPSHOT&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">parent</span>&gt;
</pre>
</div>

<p>
作用：云平台应用中的一些通用功能通过spring boot 插件来实现
</p>
<ul class="org-ul">
<li>configcenter： 配置中心支持</li>
<li>netflixext: netflix 库扩展</li>
<li>logger 文件格式</li>
<li>httptrace ：rest请求抓取</li>
<li>swagger 支持</li>
<li>&#x2026;..</li>
</ul>
</div>
<div id="outline-container-org0300206" class="outline-4">
<h4 id="org0300206">git</h4>
<div class="outline-text-4" id="text-org0300206">
<p>
git页面 <a href="https://oss.ebaotech.com/ebaocloud/platform-starters">https://oss.ebaotech.com/ebaocloud/platform-starters</a>
</p>
</div>
</div>

<div id="outline-container-org1608840" class="outline-4">
<h4 id="org1608840">property</h4>
<div class="outline-text-4" id="text-org1608840">
<p>
这里定义了依赖的platform-boot版本
</p>
<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">properties</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">ebaocloud.boot.version</span>&gt;1.0.0-SNAPSHOT&lt;/<span style="color: #daa520; font-weight: bold;">ebaocloud.boot.version</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">properties</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org4dafada" class="outline-4">
<h4 id="org4dafada">dependency</h4>
<div class="outline-text-4" id="text-org4dafada">
<p>
主要是依赖platform-boot 
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">dependencies</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;platform-boot&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;${ebaocloud.boot.version}&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
  &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

  &lt;<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;org.springframework.boot&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;spring-boot-configuration-processor&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
    &lt;<span style="color: #daa520; font-weight: bold;">optional</span>&gt;true&lt;/<span style="color: #daa520; font-weight: bold;">optional</span>&gt;
  &lt;/<span style="color: #daa520; font-weight: bold;">dependency</span>&gt;

&lt;/<span style="color: #daa520; font-weight: bold;">dependencies</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb4d2f3a" class="outline-4">
<h4 id="orgb4d2f3a">modules</h4>
<div class="outline-text-4" id="text-orgb4d2f3a">
<p>
选择那些starter做为子模块编译
</p>
<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">modules</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-configcenter&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-discoveryendpoint&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-netflixext&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-security&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-usercontext&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-swagger&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-redis&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-logger&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-httptrace&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-liquibase&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-commonstore&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-modelrestful&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">module</span>&gt;ebao-spring-boot-starter-metrics&lt;/<span style="color: #daa520; font-weight: bold;">module</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">modules</span>&gt; 
</pre>
</div>

<p>
主要是：
</p>
<ul class="org-ul">
<li>configcenter : 配置中心</li>
<li>discoveryendpoint: 服务信息写到redis</li>
<li>netflixext : ribbon, feign, restTemplate 的扩展
<ul class="org-ul">
<li>ribbon : 支持redis的服务注册模式</li>
<li>feign:  自动加上 x-ebao-tenant-id 等http头 传递给下游服务</li>
<li>restTemplate: 类似feign</li>
</ul></li>
<li>security : 基本没用到里面功能</li>
<li>usercontext : 从redis拿到缓存的用户信息，放入到 ThreadLocal</li>
<li>swagger: swagger支持，自动扫描生成swagger文件，以及相关rest服务</li>
<li>logger: 日志中打印tenant，vendor，traceid等信息</li>
<li>httptrace: jason 了解</li>
<li>liquidbase: 数据库脚本管理</li>
<li>commonstore: 存储小文件功能</li>
<li>modelrestful: 基本没用到</li>
<li>metrics: jason 了解</li>
</ul>
</div>
</div>

<div id="outline-container-orgd609d3c" class="outline-4">
<h4 id="orgd609d3c">starter</h4>
<div class="outline-text-4" id="text-orgd609d3c">
<p>
每个starter的父工程都是 <span class="underline">platform-starter-parent</span> 
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;ebao-spring-boot-starter-configcenter&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
&lt;<span style="color: #daa520; font-weight: bold;">packaging</span>&gt;jar&lt;/<span style="color: #daa520; font-weight: bold;">packaging</span>&gt;

&lt;<span style="color: #daa520; font-weight: bold;">parent</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;com.ebao.cloud&lt;/<span style="color: #daa520; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;platform-starter-parent&lt;/<span style="color: #daa520; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">version</span>&gt;1.0.0-SNAPSHOT&lt;/<span style="color: #daa520; font-weight: bold;">version</span>&gt;
  &lt;<span style="color: #daa520; font-weight: bold;">relativePath</span>&gt;../pom.xml&lt;/<span style="color: #daa520; font-weight: bold;">relativePath</span>&gt;
&lt;/<span style="color: #daa520; font-weight: bold;">parent</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org34440e4" class="outline-4">
<h4 id="org34440e4">微服务工程</h4>
<div class="outline-text-4" id="text-org34440e4">
<ul class="org-ul">
<li>父工程同样也是 ebaocloud-base-parent， 根据 <span class="underline">marker</span> 目录中不同的marker文件来确定依赖哪些starter 和 打包流程</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org946b34b" class="outline-2">
<h2 id="org946b34b">项目依赖</h2>
<div class="outline-text-2" id="text-org946b34b">
<ul class="org-ul">
<li>微服务工程中的parent是ebaocloud-base-parent，在他的pom文件里面定义了 <b>ebaocloud.platform.version</b> 属性，这个决定了每个微服务依赖的platform-starter-parent的版本</li>
<li>platform-starter-parent 的pom文件里面定义了 <b>ebaocloud.boot.version</b> 属性，这个决定了他依赖的 <span class="underline">platform-boot</span> jar包的版本</li>
<li>platform-starter-parent 的版本决定了各个starter的版本，因为starter是platform-starter-parent的子工程</li>
</ul>
</div>

<div id="outline-container-orga464e6d" class="outline-3">
<h3 id="orga464e6d">升级boot</h3>
<div class="outline-text-3" id="text-orga464e6d">
<ol class="org-ol">
<li>修改的版本号</li>
<li>发布platform-boot jar包</li>
<li>刷新platform-starter-parent 的pom文件里面定义的 <b>ebaocloud.boot.version</b> 属性为新的boot版本号</li>
<li>修改platform-starter-parent的版本号</li>
<li>修改各个starter中platform-starter-parent的版本号</li>
<li>发布platform-starter-parent jar包</li>
<li>刷新ebaocloud-base-parent的pom文件里面定义了 <b>ebaocloud.platform.version</b> 属性</li>
<li>升级ebaocloud-base-parent的版本号</li>
<li>发布ebaocloud-base-parent jar包</li>
<li>修改各个微服务中依赖的ebaocloud-base-parent的版本号</li>
<li>发布各个微服务</li>
</ol>
</div>
</div>

<div id="outline-container-org9c51668" class="outline-3">
<h3 id="org9c51668">升级starter</h3>
<div class="outline-text-3" id="text-org9c51668">
<ol class="org-ol">
<li>修改platform-starter-parent的版本号</li>
<li>修改各个starter中platform-starter-parent的版本号</li>
<li>发布platform-starter-parent jar包</li>
<li>刷新ebaocloud-base-parent的pom文件里面定义了 <b>ebaocloud.platform.version</b> 属性</li>
<li>升级ebaocloud-base-parent的版本号</li>
<li>发布ebaocloud-base-parent jar包</li>
<li>修改各个微服务中依赖的ebaocloud-base-parent的版本号</li>
<li>发布各个微服务</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orge7c890a" class="outline-2">
<h2 id="orge7c890a">升级流程</h2>
<div class="outline-text-2" id="text-orge7c890a">
<ol class="org-ol">
<li>jenkins 中触发 platform boot的升级</li>
<li>jenkins 中触发 platform starters 的升级</li>
<li>jenkins 中触发 ebaocloud base parent的升级</li>
<li>jenkins 中触发 其他java服务的升级</li>
</ol>
</div>

<div id="outline-container-org7f5d7ee" class="outline-3">
<h3 id="org7f5d7ee">boot升级</h3>
<div class="outline-text-3" id="text-org7f5d7ee">
<p>
jenkins页面配置地址： ]<a href="http://172.25.32.129/job/ebaocloud/job/release/job/platform-boot/configure">http://172.25.32.129/job/ebaocloud/job/release/job/platform-boot/configure</a>
</p>

<p>
这个升级是手动触发的， 触发的时候必须输入一个参数： platform boot 想要发布的版本号 <span class="underline">${releaseVersion}</span> 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #f08080;">set</span> -x
<span style="color: #f08080;">echo</span> <span style="color: #deb887;">"checking version from ebao repo"</span>
wget -q http://repo.ebaotech.com/artifactory/repo/com/ebao/cloud/${<span style="color: #4eee94;">service</span>}/${<span style="color: #4eee94;">releaseVersion</span>} &amp;&amp; <span style="color: #f08080;">echo</span> <span style="color: #deb887;">"Oops, version ${releaseVersion} already exists"</span> &amp;&amp; <span style="color: #00bfff; font-weight: bold;">exit</span> 1
<span style="color: #f08080;">set</span> +x

git branch -f ${<span style="color: #4eee94;">releaseVersion</span>}
git checkout ${<span style="color: #4eee94;">releaseVersion</span>}
mvn versions:set -DnewVersion=${<span style="color: #4eee94;">releaseVersion</span>}
mvn clean deploy -Dmaven.test.skip=true

git add -A
git commit -am <span style="color: #deb887;">"release the version to ${releaseVersion}"</span>
git push --set-upstream origin ${<span style="color: #4eee94;">releaseVersion</span>}
</pre>
</div>

<ol class="org-ol">
<li>校验要发布的版本在maven库中是否已经存在</li>
<li>根据版本号，生成git的一条新分支</li>
<li>代码切换到新分支</li>
<li>调用  <span class="underline">mvn versions:set -DnewVersion=${releaseVersio}</span> 设置新的版本号</li>
<li>打包，发布</li>
<li>提交修改后的代码到新分支流</li>
</ol>
</div>
</div>

<div id="outline-container-org32f65bd" class="outline-3">
<h3 id="org32f65bd">starters 升级</h3>
<div class="outline-text-3" id="text-org32f65bd">
<p>
jenkins页面配置地址： <a href="http://172.25.32.129/job/ebaocloud/job/release/job/platform-starters/configure">http://172.25.32.129/job/ebaocloud/job/release/job/platform-starters/configure</a>
</p>

<p>
这个升级是手动触发的， 触发的时候必须输入一个参数： platform starters 想要发布的版本号 <span class="underline">${releaseVersion}</span> 
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #f08080;">set</span> -x
<span style="color: #f08080;">echo</span> <span style="color: #deb887;">"checking version from ebao repo"</span>
wget -q http://repo.ebaotech.com/artifactory/repo/com/ebao/cloud/${<span style="color: #4eee94;">service</span>}/${<span style="color: #4eee94;">releaseVersion</span>} &amp;&amp; <span style="color: #f08080;">echo</span> <span style="color: #deb887;">"Oops, version ${releaseVersion} already exists"</span> &amp;&amp; <span style="color: #00bfff; font-weight: bold;">exit</span> 1
<span style="color: #f08080;">set</span> +x

mvn versions:update-properties -DincludeProperties=ebaocloud.boot.version
mvn versions:set -DnewVersion=${<span style="color: #4eee94;">releaseVersion</span>}
mvn clean deploy -Dmaven.test.skip=true

git tag ${<span style="color: #4eee94;">releaseVersion</span>}
git push origin ${<span style="color: #4eee94;">releaseVersion</span>}
</pre>
</div>
<ol class="org-ol">
<li>校验发布的版本号</li>
<li>mvn versions:update-properties -DincludeProperties=ebaocloud.boot.version ： 使用maven库中starter的最新版本号来刷新starters代码里pom文件中定义的 <b>ebaocloud.boot.version</b> ，相当于使用最新的boot中的模型2</li>
<li>打包发布</li>
<li><span class="underline">git tag ${relaseVersion}</span> 生成 <b>发布的版本号</b> 对应的git 快照</li>
<li>git库提交快照</li>
</ol>
</div>
</div>
<div id="outline-container-org967d589" class="outline-3">
<h3 id="org967d589">ebaocloud base parent 升级</h3>
<div class="outline-text-3" id="text-org967d589">
<p>
jenkins页面配置地址： <a href="http://172.25.32.129/job/ebaocloud/job/release/job/ebao-cloud-base-parent/configure">http://172.25.32.129/job/ebaocloud/job/release/job/ebao-cloud-base-parent/configure</a> 
</p>

<p>
这个升级是手动触发的， 触发的时候必须输入一个参数： ebaocloud base parent 想要发布的版本号 <span class="underline">${releaseVersion}</span> 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #f08080;">set</span> -x
<span style="color: #f08080;">echo</span> <span style="color: #deb887;">"checking version from oss..."</span>
git ls-remote | fgrep ${<span style="color: #4eee94;">releaseVersion</span>} &amp;&amp; <span style="color: #f08080;">echo</span> <span style="color: #deb887;">"version ${releaseVersion} already existed"</span> &amp;&amp; <span style="color: #00bfff; font-weight: bold;">exit</span> 1
<span style="color: #f08080;">set</span> +x

mvn versions:set -DnewVersion=${<span style="color: #4eee94;">releaseVersion</span>}
mvn clean deploy -Dmaven.test.skip=true

git commit -am <span style="color: #deb887;">"release the version to ${releaseVersion}"</span>

git tag ${<span style="color: #4eee94;">releaseVersion</span>}
git push origin ${<span style="color: #4eee94;">releaseVersion</span>}
</pre>
</div>

<p>
基本流程和前面类似，这里不做解释。但注意：
</p>
<ul class="org-ul">
<li>为了使用新版本 starters，必须 <b>手动编辑</b> 这个项目pom文件只的 <b>ebaocloud.platform.version</b> 的值，提交改动到master流，再触发发布</li>
</ul>

<pre class="example">
 不知道为啥这里没有执行自动更新 ebaocloud.platform.version的值
</pre>

<pre class="example">
发布新的pinpoint版本，也需要在这里更新属性，然后全量打包所有java服务
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd57a2b5" class="outline-2">
<h2 id="orgd57a2b5">问题和建议</h2>
<div class="outline-text-2" id="text-orgd57a2b5">
</div>
<div id="outline-container-orga8ab40e" class="outline-3">
<h3 id="orga8ab40e">循环依赖</h3>
<div class="outline-text-3" id="text-orga8ab40e">
<pre class="example">
base, boot, starters 三个工程的版本发布事实上是循环依赖 

boot 需要刷新 base的版本
starters 需要刷新base的版本，boot的版本
base需要刷新：starters版本
</pre>

<p>
建议：
</p>
<ol class="org-ol">
<li>base 中去掉 starter版本的属性，以及如何基于marker自动引入starters</li>
<li>上面删除的部分放入到platform-starers工程</li>
<li>Java微服务继承platform-starters</li>
</ol>
<pre class="example">
  当然Java微服务也可以只继承ebaocloud-base-parent, 在工程内手动添加starters的依赖
</pre>

<p>
这样：
</p>
<ul class="org-ul">
<li>ebaocloud-base-parent管理spring cloud/boot ，pinpoint等第三方库的版本，升级这些第三方库
<ol class="org-ol">
<li>修改base-parent工程的pom</li>
<li>jenkins触发ebaocloud-base-parent的发布</li>
<li>刷新platform-boot中父工程ebaocloud-base-parent的版本号，然后升级发布platform-boot</li>
<li>刷新platform-starters中父工程ebaocloud-base-parent的版本号，其中定义的platform-boot，starters等属性，升级并发布platform-starters</li>
<li>刷新各个java服务中的platform-starters-parent或ebaocloud-base-parent的版本号，升级并发布各个微服务</li>
</ol></li>
<li>boot管理starters和微服务公用的模型等信息：他的升级做上面的3，4，5</li>
<li>platform-starters管理微服务公用的插件：他的升级做上面的4和5</li>
</ul>
</div>
</div>

<div id="outline-container-org94f450f" class="outline-3">
<h3 id="org94f450f">升级脚本</h3>
<div class="outline-text-3" id="text-org94f450f">
<pre class="example">
升级脚本的流程实际上并不合理：

master流的pom文件中压根没有体现版本：基本上全是1.0.0-SNAPSHOT

实际打包中用的版本号在某个发布流或某个快照中的pom文件里
</pre>

<p>
假设开发流的版本是1.0.0-SNAPSHOT，发布的版本一般就是1.0.0， 发布完毕后开发流的版本升级到1.0.1-SNAPSHOT，一般的做法： 
</p>
<ol class="org-ol">
<li>从dev流创建一条 <span class="underline">1.0.0</span> 的作为发布流</li>
<li>在1.0.0的流上，把pom文件中的版本号从1.0.0-SNAPSHOT改成1.0.0</li>
<li>提交代码到1.0.0的流上</li>
<li>从1.0.0的发布流merge代码到master流</li>
<li>master流打包发布</li>
<li>确认发布成功后 master流提交代码</li>
<li>基于master流打出1.0.0的快照</li>
<li>切换回dev流，把dev流的版本从1.0.0-SNAPSHOT升级到1.0.1-SNAPSHOT</li>
<li>提交dev流</li>
</ol>

<pre class="example">
  这样，发布完毕后，更新完工程代码后，就知道生产版本是1.0.0， 开发版本是1.0.1-SNAPSHOT， 下次发布的版本就是1.0.1
</pre>
</div>
</div>

<div id="outline-container-orgbd24e9c" class="outline-3">
<h3 id="orgbd24e9c">项目合并</h3>
<div class="outline-text-3" id="text-orgbd24e9c">
<p>
com.ebao.base.parent 可以和 ebaocloud-base-parent这两个工程合并：
</p>
<ol class="org-ol">
<li>避免出现同时定义pinpoint版本这种事情</li>
<li>不需要再去修改unicorn的代码流</li>
</ol>
</div>
</div>

<div id="outline-container-orged917a2" class="outline-3">
<h3 id="orged917a2">功能减少</h3>
<div class="outline-text-3" id="text-orged917a2">
<p>
maven应该只关注java的库依赖和打包
</p>

<p>
至于docker, db，npm等完全没必要体现在pom文件中，这些可以在jenkins的脚本中，执行其他命令完成
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

		  <br/>
		  <div class='ds-thread'></div>
		  <script>
		  var duoshuoQuery = {short_name:'klose911'};
		  (function() {
					  var dsThread = document.getElementsByClassName('ds-thread')[0];
					  dsThread.setAttribute('data-thread-key', document.title);
					  dsThread.setAttribute('data-title', document.title);
					  dsThread.setAttribute('data-url', window.location.href);
					  var ds = document.createElement('script');
					  ds.type = 'text/javascript';ds.async = true;
					  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
					  ds.charset = 'UTF-8';
					  (document.getElementsByTagName('head')[0] 
						|| document.getElementsByTagName('body')[0]).appendChild(ds);
					  })();
		  </script>
		  <script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		  ga('create', 'UA-90850421-1', 'auto');
		  ga('send', 'pageview');
		  </script>
</div>
</body>
</html>
